<!doctype html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" >
    <meta http-equiv="X-UA-Compatible" content="IE=11,IE=10,IE=9,IE=8" >
    <meta name="baidu-site-verification" content="dIcXMeY8Ya" />
    
    <title>编写高质量iOS与OSX代码的52个有效方法 | 曾华经</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" >
    <meta name="keywords" content="iOS, Web" >
    <meta name="description" content="曾华经个人博客" >

    
    <link rel="alternative" href="/atom.xml" title="曾华经" type="application/atom+xml" >
    
    
    <link rel="shortcut icon" href="/favicon.ico" >
    
    <link rel="stylesheet" href="/css/style.css">
    <!--[if lt IE 9]>
    <script src="/js/html5.js"></script>
    <![endif]-->
    
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?fd459238242776d173cdc64918fb32f2";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


</head>

<body class="home">
    <!--[if lt IE 9]>
    <div class="browsehappy">
        当前网页 <strong>不支持</strong>
        你正在使用的浏览器. 为了正常的访问, 请 <a href="http://browsehappy.com/">升级你的浏览器</a>.
    </div>
    <![endif]-->

    <!-- 博客头部 -->
    <header class="header">
    <section class="container header-main">
        <div class="logo">
            <a href="/">
                <div class="cover">
                    <span class="name">曾华经</span>
                    <span class="description">iOS Programmer</span>
                </div>
            </a>
        </div>
        <div class="dropnav icon-paragraph-justify" id="JELON__btnDropNav"></div>
        <ul class="menu hidden" id="JELON__menu">
            
            <li rel="/post/编写高质量iOS与OSX代码的52个有效方法/index.html" class="item ">
                <a href="/" title="首页" class="icon-home">&nbsp;首页</a>
            </li>
            
            <li rel="/post/编写高质量iOS与OSX代码的52个有效方法/index.html" class="item ">
                <a href="/lab/" title="项目" class="icon-lab">&nbsp;项目</a>
            </li>
            
            <li rel="/post/编写高质量iOS与OSX代码的52个有效方法/index.html" class="item ">
                <a href="/about/" title="关于" class="icon-about">&nbsp;关于</a>
            </li>
            
            <li rel="/post/编写高质量iOS与OSX代码的52个有效方法/index.html" class="item ">
                <a href="/comment/" title="留言" class="icon-comment">&nbsp;留言</a>
            </li>
            
        </ul>
        <div class="profile clearfix">
            <div class="feeds fl">
                
                
                <p class="links">
                    
                        <a href="https://github.com/HuajingZeng" target="_blank">Github</a>
                        |
                    
                        <a href="https://github.com" target="_blank">Hosted by Github Pages</a>
                        
                    
                </p>
                <p class="sns">
                    
                        <a href="https://weibo.com/p/1005051288040665/home?from=page_100505&amp;mod=TAB#place" class="sinaweibo" target="_blank"><b>■</b> 新浪微博</a>
                    
                        <a href="" class="qqweibo" target="_blank"><b>■</b> Facebook</a>
                    
                    <a href="javascript: void(0);" class="wechat">
                        <b>■</b>
                        公众号
                        <span class="popover">
                            <img src="/img/wechat_mp.jpg" width="120" height="120" alt="我的微信订阅号">
                            <i class="arrow"></i>
                        </span>
                    </a>
                </p>
                
            </div>
            <div class="avatar fr">
                <img src="/img/zhj.jpg" alt="avatar" title="曾华经" >
            </div>
        </div>
    </section>
</header>


    <!-- 博客正文 -->
    <div class="container body clearfix">
        <section class="content">
            <div class="content-main widget">
                <!-- 文章页 -->
<!-- 目录内容 -->

    <p class="show-toc-btn" id="show-toc-btn" onclick="showToc();" style="display:block">
    <span class="btn-text">文章导航</span>
    </p>
    <div id="toc-article" class="toc-article" style="display:none">
        <span id="toc-close" class="toc-close" title="隐藏导航" onclick="showBtn();">×</span>
        <strong class="toc-title">文章目录</strong>
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#熟悉Objective-C"><span class="toc-number">1.</span> <span class="toc-text">熟悉Objective-C</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#对象、消息、运行期"><span class="toc-number">2.</span> <span class="toc-text">对象、消息、运行期</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#接口与API设计"><span class="toc-number">3.</span> <span class="toc-text">接口与API设计</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#协议与分类"><span class="toc-number">4.</span> <span class="toc-text">协议与分类</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#内存管理"><span class="toc-number">5.</span> <span class="toc-text">内存管理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#块与大中枢派发"><span class="toc-number">6.</span> <span class="toc-text">块与大中枢派发</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#系统框架"><span class="toc-number">7.</span> <span class="toc-text">系统框架</span></a></li></ol>
   </div>
   <script type="text/javascript">
    function showToc(){
        var toc_article = document.getElementById("toc-article");
        var show_toc_btn = document.getElementById("show-toc-btn");
        toc_article.setAttribute("style","display:block");
        show_toc_btn.setAttribute("style","display:none");
        };
    function showBtn(){
        var toc_article = document.getElementById("toc-article");
        var show_toc_btn = document.getElementById("show-toc-btn");
        toc_article.setAttribute("style","display:none");
        show_toc_btn.setAttribute("style","display:block");
        };
   </script>
     
<!-- 目录内容结束 -->
<!-- 文章 -->
<article class="post article" onclick="showBtn();">
    <header class="text-center">
        <h3 class="post-title"><span>编写高质量iOS与OSX代码的52个有效方法</span></h3>
    </header>
    <p class="post-meta text-center">
        曾华经&emsp;发表于
        <time datetime="2019-01-17T01:28:30.000Z">2019-01-17</time>&emsp;修改于
        <time datetime="2019-02-22T09:18:57.298Z">2019-02-22</time>
    </p>
    <div class="post-content">
        <p>&emsp;&emsp;”Effective Software Development Series”系列经典著作，世界级软件开发大师Scott Meyers亲自担当顾问编辑，Amazon全五星评价。<br>&emsp;&emsp;从语法、接口与API设计、内存管理、框架等方面总结和探讨了Objective-C编程中52个鲜为人知和容易被忽视的特性与陷阱。包含大量实用范例代码，为编写易于理解、便于维护、易于扩展和高效的Objective-C应用提供了解决方案。</p>
<a id="more"></a>
<h1 id="熟悉Objective-C"><a href="#熟悉Objective-C" class="headerlink" title="熟悉Objective-C"></a>熟悉Objective-C</h1><p><strong>【1】了解Objective-C语言的起源</strong></p>
<ul>
<li>Objective-C为C语言添加了面向对象特性，是其超集。Objective-C使用动态绑定的消息结构，也就是说，在运行时才会检查对象类型。接收一条消息后，究竟应执行何种代码，由运行期环境而非编译器来决定。</li>
<li>理解C语言的核心概念有助于写好Objective-C程序。尤其要掌握内存模型与指针。</li>
</ul>
<p><strong>【2】在类的头文件中尽量少引入其他头文件</strong></p>
<ul>
<li>除非确有必要，否则不要引入头文件。一般来说，应在某个类的头文件中使用向前声明来提及别的类，并实现文件中引入那些类的头文件。这样做可以尽量降低类之间的耦合（Coupling）。</li>
<li>有时无法使用向前声明，比如要声明某个类遵循一项协议。这种情况下，尽量把“该类遵循某协议”的这条声明移至“class-continuation分类”中。如果不行的话，就把协议单独放在一个头文件中然后将其引入。</li>
</ul>
<p><strong>【3】多用字面量语法，少用与之等价的方法</strong></p>
<ul>
<li>应该使用字面量语法来创建字符串、数值、数组、字典。与创建此类对象的常规方法相比，这么做更加简明扼要。</li>
<li>应该通过取小标操作来访问数组下标或字典中的键所对应的元素。</li>
<li>用字面量语法创建数组或字典时，若值中有nil，则会抛出异常。因此，务必确保值里不含nil。</li>
</ul>
<p><strong>【4】多用类型常量，少用#define预处理指令</strong></p>
<ul>
<li>不要用预处理指令定义常量。这样定义出来的常量不含类型信息，编译器只是会在编译前据此执行查找与替换操作。即使有人重新定义了常量值，编译器也不会产生警告信息，这将导致应用程序中的常量值不一致。</li>
<li>在实现文件中使用static const来定义“只在编译单元内可见的常量”（translation-unit-specific constant）。由于此类常量不在全局符号表中，所以无须为其名称加前缀。</li>
<li>在头文件中使用extern来声明全局常量，并在相关实现文件中定义其值。这种常量要出现在全局符号表中，所以其名称应加以区隔，通常用与之相关的类名做前缀。</li>
</ul>
<p><strong>【5】用枚举表示状态、选项、状态码</strong></p>
<ul>
<li>应该用枚举来表示状态机的状态、传递给方法的选项以及状态码等值，给这些值起个易懂的名字。</li>
<li>如果把传递给某个方法的选项表示为枚举类型，而多个选项又可以同时使用，那么就将各选项值定义为2的幂，以便通过按位或操作将其组合起来。</li>
<li>用NS_ENUM与NS_OPTIONS宏来定义枚举类型，并指明底层数据类型。这样做可以确保枚举是用开发者所选的底层数据类型实现的，而不会采用编译器所选的类型。</li>
<li>在处理枚举类型的switch语句中不要实现default分支。这样的话，加入新枚举之后，编译器就会提示开发者：switch语句并未处理所有的枚举。</li>
</ul>
<h1 id="对象、消息、运行期"><a href="#对象、消息、运行期" class="headerlink" title="对象、消息、运行期"></a>对象、消息、运行期</h1><p><strong>【6】理解“属性”这一概念</strong></p>
<ul>
<li><p><strong>【7】在对象内部尽量直接访问实例变量</strong></p>
</li>
</ul>
<p><strong>【8】理解“对象等同性”这一概念</strong></p>
<p><strong>【9】以“类簇模式”隐藏实现细节</strong></p>
<p><strong>【10】在既有类中使用关联对象存放自定义数据</strong></p>
<p><strong>【11】理解objc_msgSend的作用</strong></p>
<p><strong>【12】理解消息转发机制</strong></p>
<p><strong>【13】用“方法调配技术”调试“黑盒方法”</strong></p>
<p><strong>【14】理解“类对象”的用意</strong></p>
<h1 id="接口与API设计"><a href="#接口与API设计" class="headerlink" title="接口与API设计"></a>接口与API设计</h1><p><strong>【15】用前缀避免命名空间冲突</strong></p>
<p><strong>【16】提供“全能初始化方法”</strong></p>
<p><strong>【17】实现description方法</strong></p>
<p><strong>【18】尽量使用不可变对象</strong></p>
<p><strong>【19】使用清晰而协调的命名方式</strong></p>
<p><strong>【20】为私有方法名加前缀</strong></p>
<p><strong>【21】理解Objective-C错误模型</strong></p>
<p><strong>【22】理解NSCopying协议</strong></p>
<h1 id="协议与分类"><a href="#协议与分类" class="headerlink" title="协议与分类"></a>协议与分类</h1><p><strong>【23】通过委托与数据源协议进行对象间通信</strong></p>
<p><strong>【24】将类的实现代码分散到便于管理的数个分类之中</strong></p>
<p><strong>【25】总是为第三方类的分类名称加前缀</strong></p>
<p><strong>【26】勿在分类中声明属性</strong></p>
<p><strong>【27】使用“class-continuation分类”隐藏实现细节</strong></p>
<p><strong>【28】通过协议提供匿名对象</strong></p>
<h1 id="内存管理"><a href="#内存管理" class="headerlink" title="内存管理"></a>内存管理</h1><p><strong>【29】理解引用计数</strong></p>
<p><strong>【30】以ARC简化引用计数</strong></p>
<p><strong>【31】在dealloc方法中只释放引用并解除监听</strong></p>
<p><strong>【32】编写“异常安全代码”时留意内存管理问题</strong></p>
<p><strong>【33】以弱引用避免保留环</strong></p>
<p><strong>【34】以“自动释放池块”降低内存峰值</strong></p>
<p><strong>【35】用“僵尸对象”调试内存管理问题</strong></p>
<p><strong>【36】不要使用retainCount</strong></p>
<h1 id="块与大中枢派发"><a href="#块与大中枢派发" class="headerlink" title="块与大中枢派发"></a>块与大中枢派发</h1><p><strong>【37】理解“块”这一个概念</strong></p>
<p><strong>【38】为常用的块类型创建typedef</strong></p>
<p><strong>【39】用handler块降低代码分散程度</strong></p>
<p><strong>【40】用块引用其所属对象时不要出现保留环</strong></p>
<p><strong>【41】多用派发队列，少用同步锁</strong></p>
<p><strong>【42】多用GCD，少用performSelector系列方法</strong></p>
<p><strong>【43】掌握GCD及操作对列的使用时机</strong></p>
<p><strong>【44】通过Dispatch Group机制，根据系统资源状况来执行任务</strong></p>
<p><strong>【45】使用dispatch_once来执行只需运行一次的线程安全代码</strong></p>
<p><strong>【46】不要使用dispatch_get_current_queue</strong></p>
<h1 id="系统框架"><a href="#系统框架" class="headerlink" title="系统框架"></a>系统框架</h1><p><strong>【47】熟悉系统框架</strong></p>
<p><strong>【48】多用块枚举，少用for循环</strong></p>
<p><strong>【49】对自定义其内存管理语义的collection使用无缝桥接</strong></p>
<p><strong>【50】构建缓存时选用NSCache而非NSDictionary</strong></p>
<p><strong>【51】精简initialize与load的实现代码</strong></p>
<p><strong>【52】别忘了NSTimer会保留其目标对象</strong></p>
<p><strong>欢迎转载，转载请注明出处：<a href="http://www.huajingzeng.com" target="_blank" rel="noopener">曾华经的博客</a></strong></p>

    </div>
    <p class="post-meta">
        <span class="post-cat">分类：
            <a class="cat-link" href="/categories/编程基础/">编程基础</a>
        </span>
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/iOS/" title="iOS">iOS</a> / 
    
        <a href="/tags/OSX/" title="OSX">OSX</a>
    

        </span>
    </p>
</article>
<!-- 分享按钮 -->

  <div class="article-share clearfix text-center">
    <div class="share-area">
      <span class="share-txt">分享到：</span>
      <a href="javascript: window.open('http://service.weibo.com/share/share.php?url=' + encodeURIComponent(location.href) + '&title=' + document.title + '&language=zh_cn');" class="share-icon weibo"></a>
      <a href="javascript: alert('请复制链接到微信并发送');" class="share-icon wechat"></a>
      <!-- <a href="javascript: window.open('http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=' + encodeURIComponent(location.href) + '&title=' + document.title);" class="share-icon qqzone"></a> -->
      <a href="javascript: window.open('http://connect.qq.com/widget/shareqq/index.html?url=' + encodeURIComponent(location.href) + '&title=' + document.title + '&callback=' + encodeURIComponent(location.href));" class="share-icon qq"></a>
      <a href="javascript: window.open('http://shuo.douban.com/!service/share?href=' + encodeURIComponent(location.href) + '&name=' + document.title + '&text=' + document.title);" class="share-icon douban"></a>
    </div>
  </div>


<!-- 上一篇/下一篇 -->

<div class="article-nav clearfix">
    
    <span class="prev fl">
        上一篇<br >
        <a href="javascript: void(0);">没有上一篇了</a>
    </span>
    

    
    <span class="next fr">
        下一篇<br >
        <a href="/post/OOP概要/">
            
                OOP概要
            
        </a>
    </span>
    
</div>

<!-- 文章评论 -->

  <script src="/js/comment.js"></script>
  <div id="comments" class="comment">
    <!--
    <div class="sign-bar">
      GitHub 已登录!
      <span class="sign-link">登出</span>
    </div>
    <section class="box">
      <div class="com-avatar"><img src="/img/zhj.jpg" alt="avatar"></div>
      <div class="com-text">
        <div class="main">
          <textarea class="text-area-edited show" placeholder="欢迎评论！"></textarea>
          <div class="text-area-preview"></div>
        </div>
        <div class="switch">
          <div class="switch-item on">编辑</div>
          <div class="switch-item">预览</div>
        </div>
        <div class="button">提交</div>
      </div>
    </section>
    <section class="tips">注：评论支持 markdown 语法！</section>
    <section class="list-wrap">
      <ul class="list">
        <li>
          <div class="user-avatar">
            <a href="/">
              <img src="/img/zhj.jpg" alt="user-avatar">
            </a>
          </div>
          <div class="user-comment">
            <div class="user-comment-header">
              <span class="post-name">张德龙</span>
              <span class="post-time">2017年12月12日</span>
              <span class="like liked">已赞</span>
              <span class="like-num">2</span>
            </div>
            <div class="user-comment-body">333333</div>
          </div>
        </li>
        <li>
          <div class="user-avatar">
            <a href="/">
              <img src="/img/zhj.jpg" alt="user-avatar">
            </a>
          </div>
          <div class="user-comment">
            <div class="user-comment-header">
              <span class="post-name">刘德华</span>
              <span class="post-time">2017年12月12日</span>
              <span class="like">点赞</span>
              <span class="like-num">2</span>
            </div>
            <div class="user-comment-body">vvvvv</div>
          </div>
        </li>
      </ul>
      <div class="page-nav">
        <a href="javascript: void(0);" class="item">1</a>
        <a href="javascript: void(0);" class="item">2</a>
        <a href="javascript: void(0);" class="item current">3</a>
      </div>
    </section>
    -->
  </div>
  <script>
  JELON.Comment({
    container: 'comments',
    label: '编写高质量iOS与OSX代码的52个有效方法' || 'post/编写高质量iOS与OSX代码的52个有效方法/',
    owner: 'HuajingZeng',
    repo: 'huajingzeng.github.io_comments',
    clientId: '7ae3915c563a60d41451',
    clientSecret: '2abefe41031e15eabf12a828f30fd380487fb738'
  });
  </script>


            </div>

        </section>
        <!-- 侧栏部分 -->
<aside class="sidebar">
    <section class="widget">
        <h3 class="widget-hd"><strong>文章分类</strong></h3>
        <!-- 文章分类 -->
<ul class="widget-bd">
    
    <li>
        <a href="/categories/程序人生/">程序人生</a>
        <span class="badge">(2)</span>
    </li>
    
    <li>
        <a href="/categories/编程基础/">编程基础</a>
        <span class="badge">(8)</span>
    </li>
    
    <li>
        <a href="/categories/编程基础/开发工具/">开发工具</a>
        <span class="badge">(3)</span>
    </li>
    
</ul>
    </section>

    
    <section class="widget">
        <h3 class="widget-hd"><strong>热门标签</strong></h3>
        <!-- 文章标签 -->
<div class="widget-bd tag-wrap">
  
    <a class="tag-item" href="/tags/随笔/" title="随笔">随笔 (1)</a>
  
    <a class="tag-item" href="/tags/Shell/" title="Shell">Shell (2)</a>
  
    <a class="tag-item" href="/tags/面向对象/" title="面向对象">面向对象 (1)</a>
  
    <a class="tag-item" href="/tags/设计原则/" title="设计原则">设计原则 (1)</a>
  
    <a class="tag-item" href="/tags/设计模式/" title="设计模式">设计模式 (1)</a>
  
    <a class="tag-item" href="/tags/iOS/" title="iOS">iOS (3)</a>
  
    <a class="tag-item" href="/tags/程序员/" title="程序员">程序员 (1)</a>
  
    <a class="tag-item" href="/tags/书籍/" title="书籍">书籍 (1)</a>
  
    <a class="tag-item" href="/tags/Git/" title="Git">Git (1)</a>
  
    <a class="tag-item" href="/tags/SVN/" title="SVN">SVN (1)</a>
  
    <a class="tag-item" href="/tags/CVS/" title="CVS">CVS (1)</a>
  
    <a class="tag-item" href="/tags/代码大全/" title="代码大全">代码大全 (1)</a>
  
    <a class="tag-item" href="/tags/核对表/" title="核对表">核对表 (1)</a>
  
    <a class="tag-item" href="/tags/正则表达式/" title="正则表达式">正则表达式 (1)</a>
  
    <a class="tag-item" href="/tags/OSX/" title="OSX">OSX (1)</a>
  
</div>
    </section>
    

    

    
    <!-- 友情链接 -->
    <section class="widget">
        <h3 class="widget-hd"><strong>友情链接</strong></h3>
        <!-- 文章分类 -->
<ul class="widget-bd">
    
        <li>
            <a href="https://stackoverflow.com/" target="_blank" title="Stack Overflow">Stack Overflow</a>
        </li>
    
        <li>
            <a href="http://nshipster.cn/" target="_blank" title="NSHipster">NSHipster</a>
        </li>
    
        <li>
            <a href="http://www.sdifen.com/" target="_blank" title="史蒂芬周的博客">史蒂芬周的博客</a>
        </li>
    
        <li>
            <a href="http://www.orsoon.com/" target="_blank" title="未来软件园">未来软件园</a>
        </li>
    
</ul>
    </section>
    
</aside>
<!-- / 侧栏部分 -->
    </div>

    <!-- 博客底部 -->
    <footer class="footer">
    &copy;
    
        2016-2019
    

    <a href="/">曾华经</a>
</footer>
<div class="back-to-top" id="JELON__backToTop" title="返回顶部">返回顶部</div>

    <!--博客js脚本 -->
    <!-- 这里放网站js脚本 -->
<script src="/js/main.js"></script>
</body>
</html>