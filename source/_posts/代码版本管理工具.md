---
title: 代码版本管理工具
date: 2018-01-13 09:08:39
update: 2018-01-13 09:08:39
author: 曾华经
tags: 
	- Git
	- SVN
	- CVS
categories: 
	- 编程基础
	- 开发工具
thumbnail: /img/thumbnail/5.jpg
blogexcerpt:
toc: true
---
&emsp;&emsp;Git是一个开源的分布式版本控制系统。
&emsp;&emsp;SVN（Subversion）是一个开源的集中式版本控制系统。
&emsp;&emsp;CVS（Concurrent Versions System）是一个开源的版本控制系统，已逐渐被SVN取代。

<!--more-->

# 关于版本控制

> 版本控制是一种记录一个或若干文件内容变化，以便将来查阅特定版本修订情况的系统。

## 本地版本控制系统

![本地版本控制系统](https://githubblog-1252104787.cos.ap-guangzhou.myqcloud.com/%E6%9C%AC%E5%9C%B0%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6.png)

## 集中化的版本控制系统

![集中化的版本控制系统](https://githubblog-1252104787.cos.ap-guangzhou.myqcloud.com/%E9%9B%86%E4%B8%AD%E5%8C%96%E7%9A%84%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6.png)

## 分布式版本控制系统

![分布式版本控制系统](https://githubblog-1252104787.cos.ap-guangzhou.myqcloud.com/%E5%88%86%E5%B8%83%E5%BC%8F%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6.png)

# Git

## 起步

### 存储方式

不同于其他版本控制系统，Git直接记录快照，而非差异比较

![](https://githubblog-1252104787.cos.ap-guangzhou.myqcloud.com/%E5%AD%98%E5%82%A8%E6%AF%8F%E4%B8%AA%E6%96%87%E4%BB%B6%E4%B8%8E%E5%88%9D%E5%A7%8B%E7%89%88%E6%9C%AC%E7%9A%84%E5%B7%AE%E5%BC%82.png)

![](https://githubblog-1252104787.cos.ap-guangzhou.myqcloud.com/%E5%AD%98%E5%82%A8%E9%A1%B9%E7%9B%AE%E9%9A%8F%E6%97%B6%E9%97%B4%E6%94%B9%E5%8F%98%E7%9A%84%E5%BF%AB%E7%85%A7.png)

### 完整性和安全性

- 所有数据在存储前都计算校验和，计算校验和的机制叫做SHA-1散列（hash，哈希）。这是一个由40个十六进制字符（0-9和a-f）组成字符串（如`1a0a05cf10a6630f23aa83ef2d61394f17c869`），基于文件的内容或目录结构计算出来。Git保存的信息都是以文件内容的哈希值来索引，而不是文件名。若你在传送过程中丢失信息或损坏文件，Git就能发现
- 执行的Git操作，几乎只往数据库中增加数据。很难执行任何不可逆操作，或者以任何方式清除数据（除非执行撤销操作）

### 文件状态

- 已提交（committed）：表示数据已经安全的保存在本地数据库中
- 已修改（modified）：修改了文件，但还没保存到数据库中
- 已暂存（staged）：对一个已修改文件的当前版本做了标记，使之包含在下次提交的快照中

![工作目录、暂存区域以及 Git 仓库](https://githubblog-1252104787.cos.ap-guangzhou.myqcloud.com/%E5%B7%A5%E4%BD%9C%E7%9B%AE%E5%BD%95%E3%80%81%E6%9A%82%E5%AD%98%E5%8C%BA%E5%9F%9F%E4%BB%A5%E5%8F%8A%20Git%20%E4%BB%93%E5%BA%93.png)

### 工作流程

- 在工作目录中修改文件
- 暂存文件，将文件的快照放入暂存区域
- 提交更新，找到暂存区域的文件，将快照永久性存储到Git仓库目录

### 使用方式

- 命令行模式：终端（Mac）、命令窗口（Win）
- GUI模式：Sourcetree(Mac)

**PS：推荐使用命令行模式，因为只有在命令行模式下你才能执行Git的所有命令，而大多数的GUI软件只实现了Git所有功能的一个子集以降低操作难度**

## 安装

略

## 配置

Git自带一个`git config`的工具来帮助设置控制Git外观和行为的配置变量。 这些变量存储在三个不同的位置：

- `/etc/gitconfig`文件: 包含系统上每一个用户及他们仓库的通用配置。可以使用带有`--system`选项的`git config`对此文件进行读写和变量配置
- `~/.gitconfig`或`~/.config/git/config`文件：只针对当前用户。可以使用带有`--global`选项的`git config`对此文件进行读写和配置
- `.git/config`文件：只针对该Git仓库。

**注意：每一个级别会覆盖上一级别的配置**

### 配置用户信息

```
$ git config --global user.name "Kevin Zeng"
$ git config --global user.email zenghuajing@qq.com
```

### 配置文本编辑器

```
$ git config --global core.editor vim
```

### 检查配置信息

可以使用`git config --list`命令来列出所有Git当时能找到的配置。

```
$ git config --list
```

可以通过输入`git config <key>`来检查Git的某一项配置

```
$ git config user.name
```

### 帮助

使用以下方法获得帮助信息

```
$ git help <verb>
$ git <verb> --help
$ man git-<verb>
```

## 基础

### 获取Git仓库

#### 创建新仓库

在现有项目或目录下导入所有文件到Git中：

```
$ git init
```

该命令将创建一个名为`.git`的子目录，这个子目录含初始化的Git仓库中所有的必须文件，这些文件是Git仓库的骨干。但是，在这个时候，项目里的文件还没有被跟踪。可通过`git add`命令来实现对指定文件的跟踪，然后执行`git commit`提交：

```
$ git add *.[hm]
$ git add README
$ git commit -m 'initial project version'
```

#### 克隆现有仓库

使用`git clone`命令获得一份已经存在了的Git仓库的拷贝。

```
$ git clone https://github.com/HuajingZeng/huajingzeng.github.io
```

这会在当前目录下创建一个名为“huajingzeng.github.io”的目录，并在这个目录下初始化一个`.git`文件夹，从远程仓库拉取下所有数据放入`.git`文件夹，然后从中读取最新版本的文件的拷贝。你也可以在克隆远程仓库的时候，自定义本地仓库的名字，比如：

```
$ git clone https://github.com/HuajingZeng/huajingzeng.github.io githubblog
```

**Git支持多种数据传输协议：**

- https://协议
- git://协议
- SSH传输协议，比如 user@server:path/to/repo.git

### 记录更新

![文件的状态变化周期](https://githubblog-1252104787.cos.ap-guangzhou.myqcloud.com/%E6%96%87%E4%BB%B6%E7%9A%84%E7%8A%B6%E6%80%81%E5%8F%98%E5%8C%96%E5%91%A8%E6%9C%9F.png)

#### 检查当前文件状态

要查看哪些文件处于什么状态，可以用`git status`命令

```
$ git status
On branch master
nothing to commit, working directory clean
```

#### 跟踪新文件

使用命令`git add (file)`开始跟踪一个文件

```
$ git add README
```

**注意：`git add`命令使用文件或目录的路径作为参数，如果参数是目录的路径，该命令将递归地跟踪该目录下的所有文件**

#### 暂存已修改文件

`git add`是个多功能命令：可以用它开始跟踪新文件，或者把已跟踪的文件放到暂存区，还能用于合并时把有冲突的文件标记为已解决状态等。将这个命令理解为“添加内容到下一次提交中”而不是“将一个文件添加到项目中”要更加合适。

```
git add main.m
```

#### 状态简览

`git status`命令的输出十分详细，但其用语有些繁琐。可以使用`git status -s`命令或`git status --short`命令得到更为紧凑的格式输出

```
$ git status -s
 M text.c
MM main.m
A  marco.h
M  README
?? a.out
```

新添加的未跟踪文件前面有`??`标记，新添加到暂存区中的文件前面有`A`标记，修改过的文件前面有`M`标记。 你可能注意到了`M`有两个可以出现的位置，出现在右边的`M`表示该文件被修改了但是还没放入暂存区，出现在靠左边的`M`表示该文件被修改了并放入了暂存区。

#### 忽略文件

一般我们总会有些文件无需纳入Git的管理，也不希望它们总出现在未跟踪文件列表。在这种情况下，我们可以创建一个名为`.gitignore`的文件，列出要忽略的文件模式。文件`.gitignore`的格式规范如下：

- 所有空行或者以`＃`开头的行都会被Git忽略
- 可以使用标准的`glob`模式匹配
- 匹配模式可以以`/`开头防止递归
- 匹配模式可以以`/`结尾指定目录
- 要忽略指定模式以外的文件或目录，可以在模式前加上惊叹号`!`取反

所谓的`glob`模式是指shell所使用的简化了的正则表达式（参见[神兵利器之正则表达式](http://www.huajingzeng.com/post/%E7%A5%9E%E5%85%B5%E5%88%A9%E5%99%A8%E4%B9%8B%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/)）

**GitHub有一个十分详细的针对数十种项目及语言的`.gitignore`文件列表，你可以在[https://github.com/github/gitignore](https://github.com/github/gitignore)找到它**

#### 查看已暂存和未暂存的修改

可以用`git diff`命令查看具体修改了什么地方

- 要查看尚未暂存的文件更新了哪些部分，不加参数直接输入`git diff`
- 若要查看已暂存的将要添加到下次提交里的内容，可以用`git diff --cached`命令（Git 1.6.1 及更高版本还允许使用`git diff --staged`，效果是相同的，但更好记些）

**如果你喜欢通过图形化的方式或其它格式输出方式的话，可以使用`git difftool`命令来用 Araxis，emerge或vimdiff等软件输出diff分析结果。使用`git difftool --tool-help`命令来看你的系统支持哪些Git Diff插件**

#### 提交更新

运行提交命令`git commit`会启动文本编辑器以便输入本次提交的说明。(默认会启用shell的环境变量&#36;EDITOR所指定的软件，一般都是vim或emacs。当然也可以使用`git config --global core.editor`命令设定你喜欢的编辑软件）。另外，也可以在`git commit`命令后添加`-m`选项，将提交信息与命令放在同一行

```
$ git commit -m "Modify and add files."
[master 463dc4f] Modify and add files.
 2 files changed, 2 insertions(+)
 create mode 100644 README
```

提交后它会告诉你，当前是在哪个分支（master）提交的，本次提交的完整SHA-1校验和是什么（463dc4f），以及在本次提交中，有多少文件修订过，多少行添加和删改过等信息。

**注意：每次准备提交前，先用`git status`看下，是不是都已暂存起来了，然后再使用`git commit`提交。提交时记录的是放在暂存区域的快照。任何还未暂存的仍然保持已修改状态，可以在下次提交时纳入版本管理。**

#### 跳过使用暂存区域

只要在提交的时候，给`git commit`加上`-a`选项，Git就会，自动把所有已经跟踪过的文件暂存起来一并提交，从而跳过`git add`步骤（即跳过使用暂存区域的方式）

#### 移除文件

要从Git中移除某个文件，就必须要从已跟踪文件清单中移除（确切地说，是从暂存区域移除），然后提交。可以用`git rm`命令完成此项工作，并连带从工作目录中删除指定的文件，这样以后就不会出现在未跟踪文件清单中了。

如果只是简单地从工作目录中手工删除文件，运行`git status`时就会在“Changes not staged for commit” 部分（也就是未暂存清单）看到提示信息：

```
$ rm PROJECTS.md
$ git status
On branch master
Your branch is up-to-date with 'origin/master'.
Changes not staged for commit:
  (use "git add/rm <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

        deleted:    PROJECTS.md

no changes added to commit (use "git add" and/or "git commit -a")
```

然后再运行`git rm`记录此次移除文件的操作：

```
$ git rm PROJECTS.md
rm 'PROJECTS.md'
$ git status
On branch master
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

    deleted:    PROJECTS.md
```

如果删除之前修改过并且已经放到暂存区域的话，则必须要用强制删除选项`-f`（译注：即force的首字母）。这是一种安全特性，用于防止误删还没有添加到快照的数据，这样的数据不能被Git恢复。

另外一种情况是，我们想把文件从Git仓库中删除（亦即从暂存区域移除），但仍然希望保留在当前工作目录中使用`--cached`选项

```
$ git rm --cached README
```

#### 移动文件

Git并不显式跟踪文件移动操作。如果在Git中重命名了某个文件，仓库中存储的元数据并不会体现出这是一次改名操作。要在Git中对文件改名，可以这么做：

```
$ git mv file_from file_to
```

其实，运行`git mv`就相当于运行了下面三条命令：

```
$ mv README.md README
$ git rm README.md
$ git add README
```

**注意：直接用`git mv`轻便得多。不过有时候用其他工具批处理改名的话，要记得在提交前删除老的文件名，再添加新的文件名**

# SVN

# CVS

**欢迎转载，转载请注明出处：[曾华经的博客](http://www.huajingzeng.com)**
